<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>HBD love</title>

<!-- CSS (ROOT) -->
<link rel="stylesheet" type="text/css" href="default.css" />

<!-- JS (ROOT) -->
<script src="jquery.min.js"></script>
<script src="jscex.min.js"></script>
<script src="jscex-parser.js"></script>
<script src="jscex-jit.js"></script>
<script src="jscex-builderbase.min.js"></script>
<script src="jscex-async.min.js"></script>
<script src="jscex-async-powerpack.min.js"></script>
<script src="function.js"></script>
<script src="love.js"></script>

<script>
function playAudio(){
    var a = document.getElementById("myAudio");
    if(a) a.play();
}
</script>
</head>

<body>
<div id="main">

<audio id="myAudio">
    <source src="aud.mp3" type="audio/mp3" />
</audio>

<div id="wrap">
    <div id="text">
        <div id="code">
            <span class="say">Hey you üíû</span><br/>
            <span class="say">Happy Birthday üéà</span><br/>
            <span class="say">May God bless you üçÄ</span><br/>
            <span class="say">And give u many happiness üíï</span><br/>
            <span class="say">Just saying... you're pretty awesome ‚ù§Ô∏è</span><br/>
            <span class="say">Hope u have a great day ‚ù§Ô∏èüòò</span><br/>
        </div>
    </div>

    <canvas id="canvas" width="1100" height="680"></canvas>
</div>
</div>

<script>
(function () {

var canvas = $("#canvas");
var ctx = canvas[0].getContext("2d");
var width = canvas.width();
var height = canvas.height();

var opts = {
    seed: { x: width/2-20, color:"rgb(190,26,37)", scale:2 },
    branch: [[535,680,570,250,500,200,30,100]],
    bloom: { num:700, width:1080, height:650 },
    footer: { width:1200, height:5, speed:10 }
};

var tree = new Tree(canvas[0], width, height, opts);
var seed = tree.seed;
var hold = 1;

/* CLICK TO START */
canvas.click(function(e){
    playAudio();
    var o = canvas.offset();
    var x = e.pageX - o.left;
    var y = e.pageY - o.top;
    if(seed.hover(x,y)){
        hold = 0;
        canvas.unbind("click mousemove");
    }
});

/* SEED */
var seedAnimate = eval(Jscex.compile("async", function(){
    seed.draw();
    while(hold) $await(Jscex.Async.sleep(10));
    while(seed.canScale()){
        seed.scale(0.95);
        $await(Jscex.Async.sleep(10));
    }
}));

/* TREE */
var growAnimate = eval(Jscex.compile("async", function(){
    while(tree.canGrow()){
        tree.grow();
        $await(Jscex.Async.sleep(10));
    }
}));

/* FLOWERS */
var flowAnimate = eval(Jscex.compile("async", function(){
    while(tree.canFlower()){
        tree.flower(2);
        $await(Jscex.Async.sleep(10));
    }
}));

/* FINAL PNG AFTER TREE */
var finalPNG = eval(Jscex.compile("async", function(){
    $await(Jscex.Async.sleep(500));
    canvas.parent().css(
        "background",
        "url(" + tree.toDataURL("image/png") + ") center/contain no-repeat"
    );
}));

/* TEXT */
var textAnimate = eval(Jscex.compile("async", function(){
    $("#code").show().typewriter();
}));

/* RUN */
var run = eval(Jscex.compile("async", function(){
    $await(seedAnimate());
    $await(growAnimate());
    $await(flowAnimate());
    $await(finalPNG());
    textAnimate().start();
}));

run.start();

})();
</script>
</body>
</html>
